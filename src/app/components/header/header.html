<header class="sticky top-0 z-50 bg-white shadow border-b border-gray-200">
  <div class="flex flex-col md:flex-row items-center justify-evenly px-2 py-4 gap-2 max-w-full mx-2">
    
    <div class="flex items-center gap-2">
      <div class="text-green-600 text-3xl font-bold">
        <img src="assets/favicons/stethoscope.ico" alt="logo" loading="lazy">
      </div>
      <h1 class="text-2xl md:text-3xl font-bold text-green-700">
        Medico <span class="text-gray-700">Store</span>
      </h1>
    </div>

    <!-- Delivery Address -->
    <div *ngIf="isAuthenticated()" class="flex items-center gap-2 text-gray-700 cursor-pointer">
      üìç
      <div class="flex flex-col leading-tight">
        <span class="text-xs text-gray-500">Deliver to</span>
        <span class="font-semibold text-sm md:text-base">{{ deliveryAddress() }}</span>
      </div>
    </div>

    <!-- Search Bar with Image Search -->
    <div class="flex items-center w-full md:w-1/2 gap-2">
      <input type="text" placeholder="Search..." 
        class="w-full border-t border-l border-b rounded-md px-4 py-3 text-base outline-none">
      <button class="bg-green-600 px-5 py-3 rounded-r text-white text-lg hover:bg-green-700">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
      <!-- Image Search Trigger -->
      <label class="flex items-center gap-2 text-green-700 cursor-pointer border border-green-600 rounded-md px-3 py-2 hover:bg-green-50">
        <i class="fa-solid fa-camera"></i>
        <span class="text-sm">Search by Image</span>
        <input type="file" accept="image/*" class="hidden" (change)="onImageFileSelected($event)">
      </label>
    </div>

    <div class="flex items-center gap-6 text-gray-600 text-2xl cursor-pointer">
      
      <div (click)="onQuickOrder()" class="relative group">
        <i class="fa-solid fa-cloud-arrow-up hover:text-gray-800 transition"></i>
        <span class="absolute bottom-[-2rem] left-1/2 -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition">
          Quick Order
        </span>
      </div>

      <!-- Notifications -->
      <div *ngIf="isAuthenticated()" class="relative group">
        <i class="fa-solid fa-bell hover:text-gray-800 transition"></i>
        <span class="absolute -top-2 -right-3 bg-red-600 text-white text-xs font-bold px-1.5 py-0.5 rounded-full">1</span>
        <span class="absolute bottom-[-2rem] left-1/2 -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition">
          Notifications
        </span>
      </div>

      <!-- Offers -->
      <div class="relative group">
        <i class="fa-solid fa-tags hover:text-gray-800 transition"></i>
        <span class="absolute bottom-[-2rem] left-1/2 -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition">
          Offers
        </span>
      </div>

      <!-- Symptom Checker -->
      <div (click)="onSymptomChecker()" class="relative group">
        <i class="fa-solid fa-stethoscope hover:text-gray-800 transition"></i>
        <span class="absolute bottom-[-2rem] left-1/2 -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition">
          Symptom Checker
        </span>
      </div>

      <!-- Cart - Only visible for customers and guests, hidden for admins -->
      <div *ngIf="isCartAvailable()" (click)="onCartClick()" class="relative group">
        <i class="fa-solid fa-cart-shopping hover:text-gray-800 transition"></i>
        <span *ngIf="(cartCount())! > 0" 
          class="absolute -top-2 -right-3 bg-red-600 text-white text-xs font-bold px-1.5 py-0.5 rounded-full">
          {{ cartCount() }}
        </span>
        <span class="absolute bottom-[-2rem] left-1/2 -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition">
          Cart
        </span>
      </div>

      <!-- User - Only show for customers -->
      <div *ngIf="isCustomer()" (click)="toggleProfileSidebar()" class="relative group">
        <i class="fa-solid fa-user hover:text-gray-800 transition"></i>
        <span class="absolute bottom-[-2rem] left-1/2 -translate-x-1/2 bg-black text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition">
          Profile
        </span>
      </div>

      <!-- Login Button -->
      <button *ngIf="!(isAuthenticated())" 
        (click)="onLoginClick()"
        class="border-2 border-green-600 text-sm text-green-600 px-4 py-2 rounded-md hover:bg-green-500 hover:text-white">
        Login
      </button>
    </div>
  </div>

  <!-- Nav Links -->
  <nav class="flex flex-wrap justify-center gap-4 md:gap-6 text-lg text-gray-700 py-3 border-t max-w-[95%] mx-auto">
    <a *ngFor="let category of categories" 
      (click)="onCategoryClick(category)"
      class="hover:text-green-600 cursor-pointer">
      {{ category }}
    </a>
  </nav>

  <!-- Profile Sidebar Overlay + Panel (Customer Only) -->
  <section *ngIf="isCustomer()">
    <div id="profileOverlay" 
      [class.hidden]="!isProfileSidebarOpen()"
      (click)="closeProfileSidebar()"
      class="fixed inset-0 bg-black bg-opacity-50 z-40"></div>

    <div id="profileSidebar"
      [class.translate-x-full]="!isProfileSidebarOpen()"
      [class.translate-x-0]="isProfileSidebarOpen()"
      class="fixed top-0 right-0 w-72 h-full bg-white shadow-lg transform transition-transform duration-300 z-50">

      <!-- Close Button -->
      <div class="flex justify-between items-center p-4 border-b">
        <h2 class="text-lg font-bold text-gray-800">Account</h2>
        <button (click)="closeProfileSidebar()" class="text-gray-600 hover:text-gray-900 text-xl">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <!-- Sidebar Links -->
      <ul class="divide-y text-gray-700">
        <li (click)="navigateToProfile()" class="flex justify-between items-center p-4 hover:bg-gray-100 cursor-pointer">
          <span><i class="fa-solid fa-user-gear mr-2"></i> Manage Profile</span>
          <i class="fa-solid fa-chevron-right"></i>
        </li>
        <li (click)="navigateToOrders()" class="flex justify-between items-center p-4 hover:bg-gray-100 cursor-pointer">
          <span><i class="fa-solid fa-box-open mr-2"></i> My Orders</span>
          <i class="fa-solid fa-chevron-right"></i>
        </li>
        <li (click)="navigateToDashboard()" class="flex justify-between items-center p-4 hover:bg-gray-100 cursor-pointer">
          <span><i class="fa-solid fa-credit-card mr-2"></i> Dashboard</span>
          <i class="fa-solid fa-chevron-right"></i>
        </li>
        <li (click)="navigateToHelp()" class="flex justify-between items-center p-4 hover:bg-gray-100 cursor-pointer">
          <span><i class="fa-solid fa-circle-question mr-2"></i> Help</span>
          <i class="fa-solid fa-chevron-right"></i>
        </li>
        <li (click)="onLogout()" class="flex justify-between items-center p-4 text-red-500 hover:bg-gray-100 cursor-pointer">
          <span><i class="fa-solid fa-arrow-right-from-bracket mr-2"></i> Logout</span>
        </li>
      </ul>

    </div>
  </section>
</header>