<main class="max-w-[95%] mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Breadcrumb -->
  <nav class="flex mb-6 text-sm" aria-label="Breadcrumb">
    <ol class="inline-flex items-center space-x-1 md:space-x-3">
      <li class="inline-flex items-center">
        <a routerLink="/" class="inline-flex items-center text-gray-700 hover:text-green-600 transition-colors">
          <i class="fas fa-home mr-2"></i>
          Home
        </a>
      </li>
      <li>
        <div class="flex items-center">
          <i class="fas fa-chevron-right text-gray-400 mx-1"></i>
          <span class="text-green-600 font-medium">Profile Management</span>
        </div>
      </li>
    </ol>
  </nav>

  <!-- Page Header with Progress -->
  <div class="mb-8">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h1 class="text-4xl font-bold text-gray-900 mb-2">Profile Management</h1>
        <p class="text-gray-600">Complete your profile for a personalized healthcare experience</p>
      </div>
      <div class="flex items-center gap-4">
        <div class="text-right">
          <div class="text-2xl font-bold text-green-600">{{ completionPercent() }}%</div>
          <div class="text-sm text-gray-500">Complete</div>
        </div>
      </div>
    </div>
    <div class="w-full bg-gray-200 rounded-full h-3 mb-6">
      <div class="progress-bar h-full rounded-full" [style.--progress]="completionPercent() + '%'">
      </div>
    </div>
  </div>

  <!-- Tab Navigation -->
  <div class="flex flex-wrap gap-2 mb-8 bg-white p-2 rounded-lg shadow-sm">
    <button (click)="setTab('personal')" [class.bg-green-600]="activeTab() === 'personal'" [class.text-white]="activeTab() === 'personal'" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all">
      <i class="fas fa-user mr-2"></i>Personal Info
    </button>
    <button (click)="setTab('medical')" [class.bg-green-600]="activeTab() === 'medical'" [class.text-white]="activeTab() === 'medical'" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all">
      <i class="fas fa-heartbeat mr-2"></i>Medical Info
    </button>
    <button (click)="setTab('addresses')" [class.bg-green-600]="activeTab() === 'addresses'" [class.text-white]="activeTab() === 'addresses'" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all">
      <i class="fas fa-map-marker-alt mr-2"></i>Addresses
    </button>
    <button (click)="setTab('family')" [class.bg-green-600]="activeTab() === 'family'" [class.text-white]="activeTab() === 'family'" class="tab-btn px-6 py-3 rounded-lg font-medium transition-all">
      <i class="fas fa-users mr-2"></i>Family Members
    </button>
  </div>

  <!-- Personal Tab -->
  <div [class.hidden]="activeTab() !== 'personal'" class="tab-content">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Profile Picture -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-xl shadow-lg p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
            <i class="fas fa-camera text-green-600"></i>
            Profile Picture
          </h3>
          <div class="text-center">
            <div class="relative inline-block mb-6">
              <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="Profile" class="w-32 h-32 rounded-full object-cover border-4 border-green-200 shadow-lg">
              <button type="button" class="absolute bottom-0 right-0 w-10 h-10 bg-green-600 text-white rounded-full flex items-center justify-center">
                <i class="fas fa-camera text-sm"></i>
              </button>
            </div>
            <div class="avatar-upload rounded-lg p-6 text-center cursor-pointer mb-4">
              <i class="fas fa-cloud-upload-alt text-3xl text-green-600 mb-2"></i>
              <p class="text-sm text-gray-700 font-medium">Click to upload or drag & drop</p>
              <p class="text-xs text-gray-500">PNG, JPG up to 5MB</p>
              <input type="file" class="hidden" accept="image/*">
            </div>
            <div class="text-center">
              <button type="button" class="text-red-600 text-sm">
                <i class="fas fa-trash mr-1"></i>Remove Photo
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Personal Form -->
      <div class="lg:col-span-2">
        <div class="bg-white rounded-xl shadow-lg p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
            <i class="fas fa-id-card text-green-600"></i>
            Personal Details
          </h3>

          <form [formGroup]="personalForm" (ngSubmit)="savePersonal()" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-user mr-1 text-green-600"></i>First Name <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="firstName" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter first name">
                <small *ngIf="isInvalid(personalForm, 'firstName')" class="text-red-600">First name is required (min 2 chars)</small>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-user mr-1 text-green-600"></i>Last Name <span class="text-red-500">*</span>
                </label>
                <input type="text" formControlName="lastName" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter last name">
                <small *ngIf="isInvalid(personalForm, 'lastName')" class="text-red-600">Last name is required (min 2 chars)</small>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-phone mr-1 text-green-600"></i>Phone Number <span class="text-red-500">*</span>
                </label>
                <input type="tel" formControlName="phoneNumber" class="form-input w-full px-4 py-3 border rounded-lg bg-gray-100 cursor-not-allowed" readonly>
                <p class="text-xs text-gray-500 mt-1">Phone number cannot be changed</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-envelope mr-1 text-green-600"></i>Email Address
                </label>
                <input type="email" formControlName="email" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter email address">
                <small *ngIf="isInvalid(personalForm, 'email')" class="text-red-600">Enter a valid email</small>
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-calendar mr-1 text-green-600"></i>Date of Birth <span class="text-red-500">*</span>
                </label>
                <input type="date" formControlName="dateOfBirth" class="form-input w-full px-4 py-3 border rounded-lg">
                <small *ngIf="isInvalid(personalForm, 'dateOfBirth')" class="text-red-600">Date of birth is required</small>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-venus-mars mr-1 text-green-600"></i>Gender <span class="text-red-500">*</span>
                </label>
                <select formControlName="gender" class="form-input w-full px-4 py-3 border rounded-lg">
                  <option value="">Select Gender</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                  <option value="other">Other</option>
                </select>
                <small *ngIf="isInvalid(personalForm, 'gender')" class="text-red-600">Gender is required</small>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  <i class="fas fa-weight mr-1 text-green-600"></i>Blood Group
                </label>
                <select formControlName="bloodGroup" class="form-input w-full px-4 py-3 border rounded-lg">
                  <option value="">Select Blood Group</option>
                  <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
                  <option>AB+</option><option>AB-</option><option>O+</option><option>O-</option>
                </select>
              </div>
            </div>

            <div class="flex justify-end">
              <button type="submit" class="bg-green-600 text-white px-6 py-3 rounded-lg">Save Changes</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Medical Tab -->
  <div [class.hidden]="activeTab() !== 'medical'" class="tab-content">
    <div class="grid grid-cols-1 lg:grid-cols-1 gap-8">
      <div class="bg-white rounded-xl shadow-lg p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
          <i class="fas fa-stethoscope text-green-600"></i>
          Medical Conditions
        </h3>
        <form [formGroup]="medicalForm" (ngSubmit)="saveMedical()" class="space-y-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Known Conditions</label>
            <textarea formControlName="medicalConditions" rows="4" class="resize-none form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter any known medical conditions"></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Allergies</label>
            <textarea formControlName="allergies" rows="4" class="resize-none form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter any known allergies"></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Current Medications</label>
            <textarea formControlName="medications" rows="4" class="resize-none form-input w-full px-4 py-3 border rounded-lg" placeholder="List current medications"></textarea>
          </div>
          <div class="flex justify-end">
            <button type="submit" class="bg-green-600 text-white px-6 py-3 rounded-lg">Save Medical Info</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Addresses Tab -->
  <div [class.hidden]="activeTab() !== 'addresses'" class="tab-content">
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
        <i class="fas fa-map-marker-alt text-green-600"></i>
        Saved Addresses
      </h3>

      <!-- Address List -->
      <div class="space-y-4">
        <div *ngFor="let addr of addresses()" class="p-4 border rounded-lg flex justify-between items-start">
          <div>
            <div class="font-semibold capitalize">{{ addr.addressType }}</div>
            <div class="text-sm text-gray-600">{{ addr.addressFullName }}</div>
            <div class="text-sm">{{ addr.addressLine1 }} {{ addr.addressLine2 }}</div>
            <div class="text-sm">{{ addr.addressCity }}, {{ addr.addressState }} - {{ addr.addressZip }}</div>
            <div class="text-sm text-gray-600">ðŸ“ž {{ addr.addressPhone }}</div>
          </div>
          <button type="button" (click)="removeAddress(addr.id)" class="text-red-600">Remove</button>
        </div>
      </div>

      <button type="button" (click)="toggleAddAddress(true)" class="mt-6 bg-green-600 text-white px-6 py-3 rounded-lg">Add New Address</button>

      <!-- Add Address Form -->
      <form id="addAddressForm" [formGroup]="addressForm" class="mt-6 space-y-6 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Address Type <span class="text-red-500">*</span></label>
            <select formControlName="addressType" class="form-input w-full px-4 py-3 border rounded-lg">
              <option value="home">Home</option>
              <option value="work">Work</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name <span class="text-red-500">*</span></label>
            <input type="text" formControlName="addressFullName" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter full name">
            <small *ngIf="isInvalid(addressForm, 'addressFullName')" class="text-red-600">Full name is required</small>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Address Line 1 <span class="text-red-500">*</span></label>
          <input type="text" formControlName="addressLine1" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter address line 1">
          <small *ngIf="isInvalid(addressForm, 'addressLine1')" class="text-red-600">Address line 1 is required</small>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Address Line 2</label>
          <input type="text" formControlName="addressLine2" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter address line 2 (optional)">
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">State <span class="text-red-500">*</span></label>
            <input type="text" formControlName="addressState" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter state">
            <small *ngIf="isInvalid(addressForm, 'addressState')" class="text-red-600">State is required</small>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">City <span class="text-red-500">*</span></label>
            <input type="text" formControlName="addressCity" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter city">
            <small *ngIf="isInvalid(addressForm, 'addressCity')" class="text-red-600">City is required</small>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">ZIP Code <span class="text-red-500">*</span></label>
            <input type="text" formControlName="addressZip" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter ZIP code">
            <small *ngIf="isInvalid(addressForm, 'addressZip')" class="text-red-600">ZIP must be 5-6 digits</small>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number <span class="text-red-500">*</span></label>
          <input type="tel" formControlName="addressPhone" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter phone number">
          <small *ngIf="isInvalid(addressForm, 'addressPhone')" class="text-red-600">Enter a valid phone number</small>
        </div>
        <div class="flex justify-end gap-4">
          <button type="button" (click)="toggleAddAddress(false)" class="bg-gray-300 text-gray-700 px-6 py-3 rounded-lg">Cancel</button>
          <button type="button" (click)="saveAddress()" class="bg-green-600 text-white px-6 py-3 rounded-lg">Save Address</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Family Members Tab -->
  <div [class.hidden]="activeTab() !== 'family'" class="tab-content">
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2">
        <i class="fas fa-users text-green-600"></i>
        Family Members
      </h3>

      <!-- List -->
      <div class="space-y-4 mb-6">
        <div *ngFor="let m of familyMembers()" class="p-4 border rounded-lg flex justify-between items-start">
          <div>
            <div class="font-semibold">{{ m.fullName }}</div>
            <div class="text-sm text-gray-600">Relation: {{ m.relation }}</div>
            <div class="text-sm">DOB: {{ m.dateOfBirth }}</div>
            <div class="text-sm">Gender: {{ m.gender }}</div>
          </div>
          <button type="button" (click)="removeFamilyMember(m.id)" class="text-red-600">Remove</button>
        </div>
        <div *ngIf="familyMembers().length === 0" class="text-sm text-gray-600">No family members added yet.</div>
      </div>

      <!-- Add Member Form -->
  <form [formGroup]="newMemberGroup" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name <span class="text-red-500">*</span></label>
            <input type="text" formControlName="fullName" class="form-input w-full px-4 py-3 border rounded-lg" placeholder="Enter full name">
            <small *ngIf="isInvalid(newMemberGroup, 'fullName')" class="text-red-600">Full name is required</small>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Relation <span class="text-red-500">*</span></label>
            <select formControlName="relation" class="form-input w-full px-4 py-3 border rounded-lg">
              <option value="">Select Relation</option>
              <option value="spouse">Spouse</option>
              <option value="parent">Parent</option>
              <option value="child">Child</option>
              <option value="sibling">Sibling</option>
              <option value="other">Other</option>
            </select>
            <small *ngIf="isInvalid(newMemberGroup, 'relation')" class="text-red-600">Relation is required</small>
          </div>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Date of Birth <span class="text-red-500">*</span></label>
            <input type="date" formControlName="dateOfBirth" class="form-input w-full px-4 py-3 border rounded-lg">
            <small *ngIf="isInvalid(newMemberGroup, 'dateOfBirth')" class="text-red-600">Date of birth is required</small>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Gender <span class="text-red-500">*</span></label>
            <select formControlName="gender" class="form-input w-full px-4 py-3 border rounded-lg">
              <option value="">Select Gender</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
            <small *ngIf="isInvalid(newMemberGroup, 'gender')" class="text-red-600">Gender is required</small>
          </div>
        </div>
        <div class="flex justify-end">
          <button type="button" (click)="addFamilyMember()" class="bg-green-600 text-white px-6 py-3 rounded-lg">Add Member</button>
        </div>
      </form>
    </div>
  </div>
</main>
